---
layout: post
title: Building on Travis-CI
tags: travis gsoc
category: 'GSoC-2013'
Year: 2013
Month: 08
Date: 29
---

<h2>Commits</h2>
<p>
	<ul>
<li>Added libglib to travis: <a href="https://github.com/hyades/gst-switch/commit/d906e4b99b72c8ff8a522f3bef1520b2976159d6">d906e4b99b72c8ff8a522f3bef1520b2976159d6</a></li>
<li>travis modfied: <a href="https://github.com/hyades/gst-switch/commit/0c96d57cd3206423c32a3a77fc90d36e6b67fd4a">0c96d57cd3206423c32a3a77fc90d36e6b67fd4a</a></li>
<li>Reverting back: <a href="https://github.com/hyades/gst-switch/commit/473daed4e9c533ce7d44c5ce02f725ae7cd10338">473daed4e9c533ce7d44c5ce02f725ae7cd10338</a></li>
<li>Revert "trying out building - modified travis"

This reverts commit a823ec90679a4a91e5f0e3b01d3ce5e381581ca5.: <a href="https://github.com/hyades/gst-switch/commit/41b105dc260b0fe6389e1bfd46e096731125601d">41b105dc260b0fe6389e1bfd46e096731125601d</a></li>
<li>Revert "modified travis"

This reverts commit a13fa2f62df6db82bbda1a6e95212acc7f46a0bc.: <a href="https://github.com/hyades/gst-switch/commit/b8afe1e49b229855ca97ff76ee48b3f30153c0ff">b8afe1e49b229855ca97ff76ee48b3f30153c0ff</a></li>
<li>modified travis: <a href="https://github.com/hyades/gst-switch/commit/a13fa2f62df6db82bbda1a6e95212acc7f46a0bc">a13fa2f62df6db82bbda1a6e95212acc7f46a0bc</a></li>
<li>modified travis: <a href="https://github.com/hyades/gst-switch/commit/0259fe625feb6abbc2959614c5732a24665b8fa5">0259fe625feb6abbc2959614c5732a24665b8fa5</a></li>
<li>modified travis: <a href="https://github.com/hyades/gst-switch/commit/00b67a65f6fc1919615a7cfe9e1fbfdac836cd51">00b67a65f6fc1919615a7cfe9e1fbfdac836cd51</a></li>
<li>removed libtoolize from dependency: <a href="https://github.com/hyades/gst-switch/commit/812adbbdb7c7d59ed5247e1a9ac6b8c5da723272">812adbbdb7c7d59ed5247e1a9ac6b8c5da723272</a></li>
<li>added more dependencies: <a href="https://github.com/hyades/gst-switch/commit/5580ae1e7c57c600674baeb6cdb177d6cc9a2405">5580ae1e7c57c600674baeb6cdb177d6cc9a2405</a></li>
<li>modified config paths: <a href="https://github.com/hyades/gst-switch/commit/7c19abae2951e764dbe861cb6b179f9338512d07">7c19abae2951e764dbe861cb6b179f9338512d07</a></li>
<li>yml format fixed: <a href="https://github.com/hyades/gst-switch/commit/74e5c6eb8703c078443bbf241f0c078699ec6743">74e5c6eb8703c078443bbf241f0c078699ec6743</a></li>
<li>yml changes: <a href="https://github.com/hyades/gst-switch/commit/b7dff8b79a4e851dbe3800d6cea09585c0a2f8cc">b7dff8b79a4e851dbe3800d6cea09585c0a2f8cc</a></li>
<li>Server log displayed in case of failure of test: <a href="https://github.com/hyades/gst-switch/commit/54d0e0414d5e017fb2b8eec7c9491a66de37afe4">54d0e0414d5e017fb2b8eec7c9491a66de37afe4</a></li>
<li>typo fixed: <a href="https://github.com/hyades/gst-switch/commit/c6db27f45487f407ca21d2982583052656e7ecdd">c6db27f45487f407ca21d2982583052656e7ecdd</a></li>
<li>testing travis build - not using stage script: <a href="https://github.com/hyades/gst-switch/commit/eefa9bc6b79b490b3973f338983418151c964835">eefa9bc6b79b490b3973f338983418151c964835</a></li>
<li>pygobject modules: <a href="https://github.com/hyades/gst-switch/commit/26da4213f841570137152176d17e129bab7e4b3f">26da4213f841570137152176d17e129bab7e4b3f</a></li>
<li>Restart build: <a href="https://github.com/hyades/gst-switch/commit/772b8a5bae2dadf7510b9dee9e5059fcbc90d5b7">772b8a5bae2dadf7510b9dee9e5059fcbc90d5b7</a></li>
<li>girepository related changes to travis: <a href="https://github.com/hyades/gst-switch/commit/ff9f3b71d5ca770f0547283b6992278d2dfd2b36">ff9f3b71d5ca770f0547283b6992278d2dfd2b36</a></li>
<li>travis PyGst: <a href="https://github.com/hyades/gst-switch/commit/1513e90fb25b0f6e72e311ab349c7877c1e5d560">1513e90fb25b0f6e72e311ab349c7877c1e5d560</a></li>
<li>travis PyGst: <a href="https://github.com/hyades/gst-switch/commit/772e6b0da36260bc466f942e8ed514a808923129">772e6b0da36260bc466f942e8ed514a808923129</a></li>
<li>modified travis: <a href="https://github.com/hyades/gst-switch/commit/f933749646e0a01a600f724c686ce5a559a15bc5">f933749646e0a01a600f724c686ce5a559a15bc5</a></li>
<li>trying out building - modified travis: <a href="https://github.com/hyades/gst-switch/commit/a823ec90679a4a91e5f0e3b01d3ce5e381581ca5">a823ec90679a4a91e5f0e3b01d3ce5e381581ca5</a></li>
</ul>

</p>

<h2>
	Whats going on..
</h2>
<p>
	I am refering to the latest build on travis-ci. Following things from the logs - <a href="https://s3.amazonaws.com/archive.travis-ci.org/jobs/10719866/log.txt">https://s3.amazonaws.com/archive.travis-ci.org/jobs/10719866/log.txt</a>

	<ul>
		<li>Now after evevery failure, the entire log of the server is also displayed. All errors and warning are included in  this log</li>
		<li>All unittests pass. This indicates that atleast everything was built properly</li>
		<li>I could not find a way to use the typelibs file generated in the build process. So I am installing gir packages directly for gstreamer1.0</li>
		<li>When running the server - <code>libdc1394 error: Failed to initialize libdc1394</code></li>
		<li>
<pre><code>
./tools/gstswitchserver.c:125:info: gst_switch_server init 0x1971000
./tools/gstswitchserver.c:1518:info: Compose sink to 1001, 1002
./tools/gstcomposite.c:88:info: gst_composite init 0x1974800
./tools/gstcomposite.c:155:warning: ignore changing mode in transition
./tools/gstswitchserver.c:707:info: Listening on localhost (::1:4000)
./tools/gstswitchserver.c:707:info: Listening on localhost (::1:5000)
./tools/gstswitchserver.c:736:error: bind socket: Error binding to address: Permission denied
./tools/gstswitchcontroller.c:484:info: Controller is listening at: unix:abstract=gstswitch
./tools/gstworker.c:477:error: output: (RESOURCE: 5) Could not open resource for reading.
./tools/gstworker.c:477:error: recorder: (RESOURCE: 5) Could not open resource for reading.
</code></pre>

			This indicates something went wrong. Error binding to address: Permission denied. I am trying out different ports for the video_port , audio_port. Very much possible that the one under test is not open (probably port 1000). Also one interesting thing is that in this case compose ports are set as 1001 and 1002. Till now in numerous tests, I have seen that these are always 3001 and 3002 respectively.

		</li>
		<li>
			This one seems a big problem. This is a log portion:
<pre><code>
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <gstswitch.connection.Connection object at 0x2ccd790>

[1m    def get_encode_port(self):[0m
[1m        """get_encode_port(out i port);[0m
[1m            Calls get_encode_port remotely[0m
[1m    [0m
[1m            :param: None[0m
[1m            :returns: tuple with first element encode port number[0m
[1m            """[0m
[1m        try:[0m
[1m            args = None[0m
[1m            connection = self.connection[0m
[1m            port = connection.call_sync([0m
[1m                self.bus_name,[0m
[1m                self.object_path,[0m
[1m                self.default_interface,[0m
[1m                'get_encode_port',[0m
[1m                args,[0m
[1m                GLib.VariantType.new("(i)"),[0m
[1m                Gio.DBusCallFlags.NONE,[0m
[1m                -1,[0m
[1m>               None)[0m

gstswitch/connection.py:181: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<DBusConnection object at 0x2cd1870 (GDBusConnection at 0x2ea7200)>, None, '/info/duzy/gst/switch/SwitchController', 'info.duzy.gst.switch.SwitchControllerInterface', 'get_encode_port', None, ...)
kwargs = {}

[1m    def function(*args, **kwargs):[0m
[1m>       return info.invoke(*args, **kwargs)[0m
[1m[31mE       TypeError: Argument 1 does not allow None as a value[0m

/usr/lib/python2.7/dist-packages/gi/types.py:43: TypeError


</code></pre>

			I have tested this code in quantal, and such an issue never came up. This error seems to be due to some missing elements in the Gio modules. The Gio reference I was using is <a href="http://developer.ubuntu.com/api/ubuntu-12.10/python/Gio-2.0.html">http://developer.ubuntu.com/api/ubuntu-12.10/python/Gio-2.0.html</a>. Now this one is for 12.10. This can be due to some missing packages in gi, though not sure.
		</li>
		<li>At certain times in the day, like around 1 am IST, the travis server is busy. Since the building process requires large amounts of downloading and bandwidth is limited, there is a huge chance for the build to timeout at 50 mins. </li>
	</ul>
</p>
<h2>C Coverage</h2>
<p>With the existing gst-switch installed in <code>~/gst/stage/bin</code>, I took another copy. Now I built this using <code>./autogen && make</code>. The executable gst-switch-srv is produced in tools/ directory. Now doing <code>make coverage</code> shows the coverage. Hopefully this can be used. But this cannot be used with the executable gst-switch-srv present at <code>~/gst/stage/bin</code>, since the gcov function requires <i>.o</i> files which will be present only in the tools folder.</p>

<div class="row">	
	<div class="span9 column">
			<p class="pull-right">{% if page.previous.url %} <a href="{{page.previous.url}}" title="Previous Post: {{page.previous.title}}"><i class="icon-chevron-left"></i></a> 	{% endif %}   {% if page.next.url %} 	<a href="{{page.next.url}}" title="Next Post: {{page.next.title}}"><i class="icon-chevron-right"></i></a> 	{% endif %} </p>  
	</div>

</div>

<div class="row">	
    <div class="span9 columns">    
		<h2>Comments Section</h2>
	    <p>Feel free to comment on the post but keep it clean and on topic.</p>	
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			var disqus_shortname = 'aayushahuja'; // required: replace example with your forum shortname
			
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>

<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<!-- Google + -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<!-- Written by hyades -->

